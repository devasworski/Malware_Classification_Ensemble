# Model Notebooks (for Google Colab)

This folder contains the jupyter python notebooks that are designed to be executed within a Google Colab environment.

It contains the notebook to train the three individual models and the ensemble model. The ensemble model will use the pre-trained weight of the individual models, which can be found in the `.weights`subfolder.

The following models have been replicated:

- MalVecNet based on Jiang et al. 2019 **[1]**
- BitNet based on Lin and Yeh 2022 **[2]**
- VisNet based Pinhero et al. 2021 **[3]**

Details on the replication can be found in the report and a TL;DR can be found within the notebook of each model.

### Instructions
#### 0. Mlflow
 All the notebooks require that the MLflow server is running. The notebooks presume that the MLflow server is accessable through the ngrok tunnels. As the ngrok access changed each time the containers are started, the address needs to be obtained and entered into the notebook according to the instructions in the `mlflow server/readme.md`.
#### 1. Setup of Google drive
Due to the nature of Google Colab, the notebooks are designed to copy the files they require from Google Drive. For this, the notebook presumes that the entire repository has been copied to Google Drive. The location of the repository within Google Drive has to be specified within the `GDRIVE_LOCATION` variable that each notebook defines and the standard value is `MyDrive/git/Malware_Classification_Ensemble`. The repository copy on Google Drive needs to include all files previously created following the instructions in the `data_processing` folder with the exception of the raw files in the `data/BIG_2015` folder.
Lastly, the Google Colab environment needs to be connected to Google Drive. Instructions on how to achieve this can be found [here](https://colab.research.google.com/notebooks/io.ipynb#scrollTo=u22w3BFiOveA). 
#### 2. Training the models
To train the models, the following notebooks have to be executed respectively:
|Model|notebook|Open in Colab|
|---|---|---|
|__MalVecNet__|`Assembly_Input_Model.ipynb`|<a href="https://colab.research.google.com/github/devasworski/Malware_Classification_Ensemble/blob/main/notebooks/Assembly_Input_Model.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a>|
|__BitNet__|`Bytes_Input_Model.ipynb`|<a href="https://colab.research.google.com/github/devasworski/Malware_Classification_Ensemble/blob/main/notebooks/Bytes_Input_Model.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a>|
|__VisNet__|`Entropy_Input_Model.ipynb`|<a href="https://colab.research.google.com/github/devasworski/Malware_Classification_Ensemble/blob/main/notebooks/Entropy_Input_Model.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a>|
||||
|__EBANet__|`Ensemble.ipynb`|<a href="https://colab.research.google.com/github/devasworski/Malware_Classification_Ensemble/blob/main/notebooks/Ensemble.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a>|


All outputs can be seen on the [mlflow dashboard](http://127.0.0.1:5501) (accessible on the host of the mlflow server). There, the trained weight can be downloaded if one wants to replace the existing weight in the `models/.weights` subfolder.

### References
**[1]** Y. Jiang, S. Li, Y. Wu, and F. Zou, ‘A Novel Image-Based Malware Classification Model Using Deep Learning’, in Neural Information Processing, vol. 11954, T. Gedeon, K. W. Wong, and M. Lee, Eds. Cham: Springer International Pub, 2019, pp. 150–161. doi: 10.1007/978-3-030-36711-4_14.
**[2]** W.-C. Lin and Y.-R. Yeh, ‘Efficient Malware Classification by Binary Sequences with One-Dimensional Convolutional Neural Networks’, Mathematics, vol. 10, no. 4, p. 608, Feb. 2022, doi: 10.3390/math10040608.
**[3]** A. Pinhero et al., ‘Malware detection employed by visualization and deep neural network’, Computers & Security, vol. 105, p. 102247, Jun. 2021, doi: 10.1016/j.cose.2021.102247.
