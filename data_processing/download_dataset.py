# This file will download and unzip the latest version of the Kaggle Microsoft BIG 2015 dataset from kaggle and save it inside the data directory.

import getpass
from os import environ
from os import system
from os import path
import py7zr

if path.exists('../data/BIG_2015/train'):
    print('Dataset already downloaded')
    exit(0)
KAGGLE_USERNAME = getpass.getpass("Whats your kaggle username?")
KAGGLE_KEY = getpass.getpass("Whats your kaggle key?")
environ["KAGGLE_USERNAME"] = KAGGLE_USERNAME
environ["KAGGLE_KEY"] = KAGGLE_KEY
system('kaggle competitions download -c malware-classification -p ../data/BIG_2015/')
system('unzip ../data/BIG_2015/malware-classification.zip -d ../data/BIG_2015/')
system('rm ../data/BIG_2015/malware-classification.zip')
print('Extracting train.7z ...')
with py7zr.SevenZipFile('../data/BIG_2015/train.7z', mode='r') as z:
    z.extractall('../data/BIG_2015/')
print('train.7z extracted')
system('rm ../data/BIG_2015/train.7z')
print('Extracting test.7z ...')
with py7zr.SevenZipFile('../data/BIG_2015/test.7z', mode='r') as z:
    z.extractall('../data/BIG_2015/')
print('test.7z extracted')
system('rm ../data/BIG_2015/test.7z')
print('done')
