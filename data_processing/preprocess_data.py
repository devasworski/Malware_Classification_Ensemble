import numpy as np
from preprocessing import bitnet, malvecnet
from tqdm import tqdm
from os import path, makedirs
from multiprocessing import Pool

x_data = np.load(f'../data/splits/raw/all_shuffled_train_filenames.npy')

print('(1/3) Process data for MalVecNet:')
if not path.exists(f'../data/MalVecNet/{malvecnet.PROCESS_VERSION}'):
  makedirs(f'../data/MalVecNet/{malvecnet.PROCESS_VERSION}')
with tqdm(total=len(x_data)) as progress_bar:
    for x in x_data:
        malvecnet.preprocess(x,origin_folder='../data/BIG_2015/train',dest_folder='../data/MalVecNet')
        progress_bar.update(1)

print('(2/3) Process data for BitNet:')
if not path.exists(f'../data/BitNet/{bitnet.PROCESS_VERSION}'):
  makedirs(f'../data/BitNet/{bitnet.PROCESS_VERSION}')
with tqdm(total=len(x_data)) as progress_bar:
    for x in x_data:
        bitnet.preprocess(x,origin_folder='../data/BIG_2015/train',dest_folder='../data/BitNet')
        progress_bar.update(1)

print('(3/3) Process data for VisNet:')
print('TODO: Not implemented')
with tqdm(total=len(x_data)) as progress_bar:
    for x in x_data:
        #visnet.preprocess(x,origin_folder='../data/BIG_2015/train',dest_folder='../data/bitnet')
        progress_bar.update(1)
