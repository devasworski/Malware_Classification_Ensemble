# Models

This folder contains the python scripts to train the three individual models, and the python script to train the ensemble model. The ensemble model will use the pre-trained weight of the individual models, which can be found in the `.weights`subfolder.

The following models have been replicated:

- MalVecNet based on Jiang et al. 2019 **[1]**
- BitNet based on Lin and Yeh 2022 **[2]**
- VisNet based Pinhero et al. 2021 **[3]**

Details on the replication can be found in the report and a TL;DR can be found within the notebook of each model.

### Instructions
#### 0. Mlflow
 All python scripts require that the MLflow server is running. The script presumes, that the MLflow server is located on the same host. Should this not be the case, the IP address used in the script needs to be changed to either use the ngrok tunnels or the local IP address.
#### 1. Dependencies
run the following command within this folder:
            
    pip install -r requirements.txt

This will install all dependencies required for the scripts within this folder. If you use a python environment, activate it before executing this command.
#### 2. Training the models
To train the individual models, the following scripts have to be executed respectively:
|Model|script|
|---|---|
|__MalVecNet__|`MalVecNet.py`|
|__BitNet__|`BitNet.py`|
|__VisNet__|`VisNet.py`|

All outputs can be seen on the [mlflow dashboard](http://127.0.0.1:5501). There, the trained weight can be downloaded if one wants to replace the existing weight in the `.weights` subfolder.

To train the ensemble model, the file `Ensemble.py` has to be executed. This will use the pre-trained weight of the individual models.

#### 3. Making predictions
No script has been implemented to make predictions based on the ensemble model individually. The required code is available within the `Ensemble.py` file. The trained weight of the final ensemble model can also be found in the `.weights` subfolder.

### References
**[1]** Y. Jiang, S. Li, Y. Wu, and F. Zou, ‘A Novel Image-Based Malware Classification Model Using Deep Learning’, in Neural Information Processing, vol. 11954, T. Gedeon, K. W. Wong, and M. Lee, Eds. Cham: Springer International Pub, 2019, pp. 150–161. doi: 10.1007/978-3-030-36711-4_14.
**[2]** W.-C. Lin and Y.-R. Yeh, ‘Efficient Malware Classification by Binary Sequences with One-Dimensional Convolutional Neural Networks’, Mathematics, vol. 10, no. 4, p. 608, Feb. 2022, doi: 10.3390/math10040608.
**[3]** A. Pinhero et al., ‘Malware detection employed by visualization and deep neural network’, Computers & Security, vol. 105, p. 102247, Jun. 2021, doi: 10.1016/j.cose.2021.102247.
